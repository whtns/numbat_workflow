---
title: "R Notebook"
author: "Kevin Stachelek"
output: html_notebook
---

```{r setup, echo = F}
knitr::opts_chunk$set(echo = F, message = F, warning = F)
```

```{r}
library('tidyverse')
library('fs')
library('rprojroot')
library(seuratTools)
proj_dir = rprojroot::find_root(criterion = has_file_pattern("*.Rproj"))
```

```{r}
txi_genes <- seuratTools::load_counts_from_stringtie(proj_dir, txOut = F)
txi_transcripts <- seuratTools::load_counts_from_stringtie(proj_dir, txOut = T)
```

```{r}
tpm_meta <- seuratTools::load_meta(proj_dir)
```


```{r}
feature_seus <- map(list(gene = txi_genes, transcript = txi_transcripts), seu_from_tibbles, tpm_meta)
```

```{r}
purrr::imap(feature_seus, save_seurat)
```


```{r}
purrr::imap(feature_seus_thresh, save_seurat)
```

```{r}
feature_seus_thresh_ps <- path(proj_dir, "output", "sce", paste0(c("gene", "transcript"), "_seu.rds"))

feature_seus_thresh <- map(feature_seus_thresh_ps, readRDS)
```



