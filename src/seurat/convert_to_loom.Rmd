---
title: "R Notebook"
author: "Kevin Stachelek"
output: html_notebook
---

```{r setup, echo = F}
knitr::opts_chunk$set(echo = F, message = F, warning = F)
library(seuratTools)
library(Seurat)
library(tidyverse)
library(rprojroot)
library(fs)
proj_dir <- find_root(criterion = has_file_pattern("*.Rproj"))
```

```{r}

seus <- unlist(load_seurat_from_rds(proj_dir))

```

```{r}

Idents(seus[[1]]) <- "clusters_1"

# find markers for every cluster compared to all remaining cells, report only the positive ones
seu.markers <- FindAllMarkers(object = seus[[1]], only.pos = TRUE, min.pct = 0.25, logfc.threshold = 0.25)

seu.markers <- seu.markers %>% 
  group_by(cluster) %>% 
  top_n(n = 2, wt = avg_logFC)

marker_genes <- unique(seu.markers$gene)

```


```{r, eval = F}

test <- DotPlot(seus[[1]], features = marker_genes) + 
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))

library(plotly)

ggplotly(test)

```



