\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={batch\_effect\_lun.rmd},
            pdfauthor={Kevin Stachelek},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{batch\_effect\_lun.rmd}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{Kevin Stachelek}
    \preauthor{\centering\large\emph}
  \postauthor{\par}
      \predate{\centering\large\emph}
  \postdate{\par}
    \date{8/22/2018}


\begin{document}
\maketitle

\begin{verbatim}
## -- Attaching packages -------------------------------------------------------------------------------------------------- tidyverse 1.2.1 --
\end{verbatim}

\begin{verbatim}
## √ tibble  1.4.2     √ purrr   0.2.5
## √ tidyr   0.8.1     √ dplyr   0.7.6
## √ readr   1.1.1     √ stringr 1.3.1
## √ tibble  1.4.2     √ forcats 0.3.0
\end{verbatim}

\begin{verbatim}
## -- Conflicts ----------------------------------------------------------------------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
## x dplyr::select() masks MASS::select()
\end{verbatim}

\begin{verbatim}
## Loading required package: SummarizedExperiment
\end{verbatim}

\begin{verbatim}
## Loading required package: GenomicRanges
\end{verbatim}

\begin{verbatim}
## Loading required package: stats4
\end{verbatim}

\begin{verbatim}
## Loading required package: BiocGenerics
\end{verbatim}

\begin{verbatim}
## Loading required package: parallel
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'BiocGenerics'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:parallel':
## 
##     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ, clusterExport, clusterMap, parApply, parCapply, parLapply, parLapplyLB, parRapply, parSapply, parSapplyLB
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:dplyr':
## 
##     combine, intersect, setdiff, union
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:stats':
## 
##     IQR, mad, sd, var, xtabs
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     anyDuplicated, append, as.data.frame, basename, cbind, colMeans, colnames, colSums, dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep, grepl, intersect, is.unsorted, lapply, lengths, Map, mapply, match, mget, order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank, rbind, Reduce, rowMeans, rownames, rowSums, sapply, setdiff, sort,
##     table, tapply, union, unique, unsplit, which, which.max, which.min
\end{verbatim}

\begin{verbatim}
## Loading required package: S4Vectors
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'S4Vectors'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:dplyr':
## 
##     first, rename
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:tidyr':
## 
##     expand
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:base':
## 
##     expand.grid
\end{verbatim}

\begin{verbatim}
## Loading required package: IRanges
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'IRanges'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:dplyr':
## 
##     collapse, desc, slice
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:purrr':
## 
##     reduce
\end{verbatim}

\begin{verbatim}
## Loading required package: GenomeInfoDb
\end{verbatim}

\begin{verbatim}
## Loading required package: Biobase
\end{verbatim}

\begin{verbatim}
## Welcome to Bioconductor
## 
##     Vignettes contain introductory material; view with 'browseVignettes()'. To cite Bioconductor, see 'citation("Biobase")', and for packages 'citation("pkgname")'.
\end{verbatim}

\begin{verbatim}
## Loading required package: DelayedArray
\end{verbatim}

\begin{verbatim}
## Loading required package: matrixStats
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'matrixStats'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:Biobase':
## 
##     anyMissing, rowMedians
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:dplyr':
## 
##     count
\end{verbatim}

\begin{verbatim}
## Loading required package: BiocParallel
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'DelayedArray'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:matrixStats':
## 
##     colMaxs, colMins, colRanges, rowMaxs, rowMins, rowRanges
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:purrr':
## 
##     simplify
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     aperm, apply
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'scater'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:S4Vectors':
## 
##     rename
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:dplyr':
## 
##     arrange, filter, mutate, rename
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:stats':
## 
##     filter
\end{verbatim}

\begin{verbatim}
## Loading required package: AnnotationDbi
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'AnnotationDbi'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:dplyr':
## 
##     select
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:MASS':
## 
##     select
\end{verbatim}

\begin{verbatim}
## 
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'plotly'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:AnnotationDbi':
## 
##     select
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:scater':
## 
##     arrange, filter, mutate, rename
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:IRanges':
## 
##     slice
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:S4Vectors':
## 
##     rename
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:ggplot2':
## 
##     last_plot
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:MASS':
## 
##     select
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:stats':
## 
##     filter
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:graphics':
## 
##     layout
\end{verbatim}

\begin{verbatim}
## Warning: Column `sample_id` joining factors with different levels, coercing to character vector
\end{verbatim}

\begin{verbatim}
## Warning: Column `sample_id` joining character vector and factor, coercing into character vector

## Warning: Column `sample_id` joining character vector and factor, coercing into character vector

## Warning: Column `sample_id` joining character vector and factor, coercing into character vector

## Warning: Column `sample_id` joining character vector and factor, coercing into character vector

## Warning: Column `sample_id` joining character vector and factor, coercing into character vector

## Warning: Column `sample_id` joining character vector and factor, coercing into character vector

## Warning: Column `sample_id` joining character vector and factor, coercing into character vector

## Warning: Column `sample_id` joining character vector and factor, coercing into character vector

## Warning: Column `sample_id` joining character vector and factor, coercing into character vector

## Warning: Column `sample_id` joining character vector and factor, coercing into character vector

## Warning: Column `sample_id` joining character vector and factor, coercing into character vector

## Warning: Column `sample_id` joining character vector and factor, coercing into character vector
\end{verbatim}

\begin{verbatim}
## [1] "cells X1 X1 X1 X10 X100 X101 X102 X103 X104 X105 X106 X107 X108 X109 X11 X110 X111 X112 X113 X114 X115 X116 X117 X118 X119 X12 X120 X121 X122 X123 X124 X125 X126 X127 X128 X129 X13 X130 X131 X132 X133 X134 X135 X136 X137 X138 X139 X14 X140 X141 X142 X143 X144 X145 X146 X147 X148 X149 X15 X150 X151 X152 X153 X154 X155 X156 X157 X158 X159 X16 X160 X161 X162 X163 X164 X165 X166 X167 X168 X169 X17 X170 X171 X172 X173 X174 X175 X176 X177 X178 X179 X18 X180 X181 X182 X183 X184 X185 X186 X187 X188 X189 X19 X190 X191 X192 X193 X194 X195 X196 X197 X198 X199 X2 X20 X200 X201 X202 X203 X204 X205 X206 X207 X208 X209 X21 X210 X211 X212 X213 X214 X215 X216 X217 X218 X219 X22 X220 X221 X222 X223 X224 X225 X226 X227 X228 X229 X23 X230 X231 X232 X233 X234 X235 X236 X237 X238 X239 X24 X240 X241 X242 X243 X244 X245 X246 X247 X248 X249 X25 X250 X251 X252 X253 X254 X255 X256 X257 X258 X259 X26 X260 X261 X262 X263 X264 X265 X266 X267 X268 X269 X27 X270 X271 X272 X273 X274 X275 X276 X277 X278 X278 X278 X279 X28 X280 X281 X282 X283 X284 X285 X286 X287 X288 X29 X3 X30 X31 X313 X314 X315 X316 X317 X318 X319 X32 X320 X321 X322 X323 X324 X325 X326 X327 X328 X329 X33 X330 X331 X332 X333 X334 X335 X336 X337 X338 X339 X34 X340 X341 X342 X343 X344 X345 X346 X347 X348 X349 X35 X350 X351 X352 X353 X354 X355 X356 X357 X358 X359 X36 X360 X361 X362 X363 X364 X365 X366 X367 X368 X369 X37 X370 X371 X372 X373 X374 X375 X376 X377 X378 X379 X38 X380 X381 X382 X383 X384 X385 X386 X387 X388 X389 X390 X391 X392 X393 X394 X395 X396 X397 X398 X399 X4 X400 X401 X402 X403 X404 X405 X406 X407 X408 X409 X410 X411 X412 X413 X414 X415 X416 X417 X418 X419 X420 X421 X422 X423 X424 X425 X426 X427 X428 X429 X430 X431 X432 X433 X434 X435 X436 X437 X438 X439 X440 X441 X442 X443 X444 X445 X446 X447 X448 X449 X450 X451 X452 X453 X454 X455 X456 X457 X458 X459 X460 X461 X462 X463 X464 X465 X466 X467 X468 X469 X470 X471 X472 X473 X474 X475 X476 X477 X478 X479 X480 X481 X482 X483 X484 X485 X486 X487 X488 X489 X490 X491 X492 X493 X494 X495 X496 X497 X498 X499 X5 X500 X501 X502 X503 X504 X505 X506 X507 X508 X509 X510 X6 X7 X8 X9 X97 X98 X99 found duplicated in cell sets! They will be removed from analysis"
\end{verbatim}

We create a SingleCellExperiment object to store the counts and metadata
together. This reduces the risk of book-keeping errors in later steps of
the analysis.

\section{4 Performing MNN-based
correction}\label{performing-mnn-based-correction}

\begin{verbatim}
## [1] 793  50
\end{verbatim}

\begin{verbatim}
## character-Rle of length 793 with 2 runs
##   Lengths:     275     518
##   Values : "exp1_" "exp2_"
\end{verbatim}

\begin{verbatim}
## [[1]]
## DataFrame with 1194 rows and 2 columns
##          first    second
##      <integer> <integer>
## 1            2       313
## 2            3       347
## 3            4       360
## 4            4       641
## 5            4       585
## ...        ...       ...
## 1190       273       526
## 1191       273       671
## 1192       273       593
## 1193       273       483
## 1194       275       413
\end{verbatim}

\section{5 Examining the effect of
correction}\label{examining-the-effect-of-correction}

\begin{verbatim}
## class: SingleCellExperiment 
## dim: 647 793 
## metadata(0):
## assays(1): logcounts
## rownames(647): ENST00000547765 ENST00000229264 ... ENST00000601638 ENST00000490078
## rowData names(0):
## colnames(793): exp1_X1 exp1_X2 ... exp2_X571 exp2_X572
## colData names(1): Batch
## reducedDimNames(1): MNN
## spikeNames(0):
\end{verbatim}

\includegraphics{batch_effect_lun_files/figure-latex/unnamed-chunk-8-1.pdf}
\includegraphics{batch_effect_lun_files/figure-latex/unnamed-chunk-8-2.pdf}

\section{6 Using the corrected values in downstream
analyses}\label{using-the-corrected-values-in-downstream-analyses}

\begin{verbatim}
##    
##     exp1_ exp2_
##   1    27   340
##   2   248   178
\end{verbatim}

\includegraphics{batch_effect_lun_files/figure-latex/unnamed-chunk-9-1.pdf}


\end{document}
